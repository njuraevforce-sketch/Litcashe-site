<!DOCTYPE html>

<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Кабинет — Litcash</title>
<style>
:root{ --bg:#0f1115; --bg-2:#0b0e13; --card:#161a22; --muted:#8d96a7; --text:#e6e9ef; --accent:#00eaff; --accent-2:#1e88e5; --success:#17c964; --danger:#ef4444; --warning:#f59e0b; --radius:16px; --shadow:0 8px 30px rgba(0,0,0,.35); }
*{box-sizing:border-box}
html,body{display:flex;flex-direction:column;min-height:100vh;height:100%}
body{margin:0;background:
  radial-gradient(1200px 600px at -10% -30%, rgba(30,136,229,.15), transparent 55%),
  radial-gradient(900px 400px at 110% 10%, rgba(0,234,255,.15), transparent 60%),
  linear-gradient(180deg, var(--bg-2), var(--bg));color:var(--text);
  font:15px/1.6 "Inter", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;}
a{color:var(--text);text-decoration:none}
.container{width:min(1200px,92vw);margin:0 auto;padding:24px 0}
.card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:20px;box-shadow:var(--shadow);padding:20px;backdrop-filter:blur(6px)}
.grid{display:grid;gap:18px}
.grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}
.grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
@media (max-width:980px){.grid-3,.grid-2{grid-template-columns:1fr}}
.muted{color:var(--muted)}
.badge{display:inline-flex;align-items:center;gap:8px;height:28px;padding:0 10px;font-size:12px;border-radius:999px;background:rgba(0,234,255,.12);color:#cfe9ff;border:1px solid rgba(0,234,255,.25)}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;height:48px;padding:0 24px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:linear-gradient(180deg, rgba(0,234,255,.18), rgba(30,136,229,.18));color:white;font-weight:700;letter-spacing:.2px;cursor:pointer;transition:transform .15s ease, box-shadow .2s ease;box-shadow:0 8px 22px rgba(30,136,229,.35)}
.btn:hover{transform:translateY(-1px);box-shadow:0 12px 26px rgba(30,136,229,.45)}
.btn.start{height:64px;font-size:18px;border-radius:18px}
.table{width:100%;border-collapse:separate;border-spacing:0 10px}
.table th,.table td{padding:12px 14px;text-align:left}
.table tr{background:rgba(255,255,255,.03);border-radius:12px}
.table tr:hover{background:rgba(255,255,255,.06)}
.progress{height:10px;background:rgba(255,255,255,.08);border-radius:999px;overflow:hidden}
#progressFill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2))}
.video{width:100%;border-radius:16px;border:1px solid rgba(255,255,255,.08);overflow:hidden;aspect-ratio:16/9;background:#0b0e13}
.header{position:sticky;top:0;z-index:50;backdrop-filter:saturate(180%) blur(8px);background:rgba(10,12,18,.6);border-bottom:1px solid rgba(255,255,255,.08)}
.nav{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
.brand{display:flex;align-items:center;gap:10px;font-weight:800;color:white}
.brand .logo{width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--accent-2));box-shadow:0 6px 18px rgba(0,234,255,.45)}
.nav-links{display:flex;align-items:center;gap:14px}
.nav-cta{display:flex;align-items:center;gap:10px}
</style>
<link href="assets/css/lang-switcher.css" rel="stylesheet"/>
<style id="lc-lang-style-inline">
/* LC Globe (inline) */
#lc-inline-lang{position:relative;display:inline-flex;align-items:center}
#lc-inline-lang .lc-lang__btn{width:36px;height:36px;display:inline-flex;align-items:center;justify-content:center;border-radius:999px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.06);color:#eee;cursor:pointer;transition:transform .08s ease,box-shadow .2s ease,background .2s ease;backdrop-filter:blur(6px)}
#lc-inline-lang .lc-lang__btn:hover{box-shadow:0 2px 12px rgba(0,0,0,.35);background:rgba(255,255,255,.12)}
#lc-inline-lang .lc-lang__btn:active{transform:translateY(1px)}
#lc-inline-lang .lc-lang__icon{width:18px;height:18px}
#lc-inline-lang .lc-lang__menu{list-style:none;margin:8px 0 0;padding:6px 0;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:rgba(20,20,20,.96);color:#eee;position:absolute;right:0;min-width:140px;box-shadow:0 12px 24px rgba(0,0,0,.35);display:none;z-index:99999}
#lc-inline-lang.is-open .lc-lang__menu{display:block}
#lc-inline-lang .lc-lang__menu li{padding:8px 12px;cursor:pointer}
#lc-inline-lang .lc-lang__menu li:hover{background:rgba(255,255,255,.08)}
body>#lc-inline-lang.lc-floating{position:fixed;right:16px;top:16px;z-index:99999}
@media (prefers-color-scheme:light){
  #lc-inline-lang .lc-lang__btn{border-color:rgba(0,0,0,.12);background:rgba(255,255,255,.85);color:#111}
  #lc-inline-lang .lc-lang__menu{background:#fff;color:#111;border-color:rgba(0,0,0,.12)}
  #lc-inline-lang .lc-lang__menu li:hover{background:rgba(0,0,0,.06)}
}
</style><style id="lc-lang-inline">/* LC Globe — forced dark style */
.lc-lang{position:relative;display:inline-flex;align-items:center}
.lc-lang__btn{height:36px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.18)!important;background:rgba(255,255,255,.06)!important;color:#eee!important;display:inline-flex;gap:8px;align-items:center;cursor:pointer;backdrop-filter:blur(6px);transition:transform .08s ease,box-shadow .2s ease,background .2s ease}
.lc-lang__btn:hover{box-shadow:0 2px 12px rgba(0,0,0,.35);background:rgba(255,255,255,.12)!important}
.lc-lang__btn:active{transform:translateY(1px)}
.lc-lang__icon{width:16px;height:16px}
.lc-lang__label{font-size:12px;line-height:1}
.lc-lang__menu{position:absolute;top:calc(100% + 8px);right:0;list-style:none!important;padding-left:0!important;margin:8px 0 0;padding:6px 0;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(20,20,20,.96)!important;color:#eee!important;min-width:160px;box-shadow:0 12px 24px rgba(0,0,0,.35);display:none;z-index:10000}
.lc-lang.is-open .lc-lang__menu{display:block}
.lc-lang__menu li{padding:8px 12px;cursor:pointer}
.lc-lang__menu li:hover{background:rgba(255,255,255,.08)}</style><style id="lang-select-inline">
/* Styled <select> pill with globe */
.lang-select{
  -webkit-appearance:none; -moz-appearance:none; appearance:none;
  background: rgba(255,255,255,.06) url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm0 18a8 8 0 0 1 0-16v16zm1-16a8 8 0 0 1 0 16V4zM4.7 7h14.6M4.7 17h14.6M12 2a15 15 0 0 0 0 20M12 2a15 15 0 0 1 0 20" fill="none" stroke="white" stroke-width="1.4"/></svg>') no-repeat 10px 50%;
  border: 1px solid rgba(255,255,255,.18);
  border-radius: 999px;
  padding: 8px 28px 8px 34px;
  color: #eee; font-size: 12px; line-height: 1; cursor: pointer;
  backdrop-filter: blur(6px);
}
.lang-select:focus{ outline:none; box-shadow:0 2px 12px rgba(0,0,0,.35); }
.lang-select option{ color:#111; }
@media (prefers-color-scheme:light){
  .lang-select{ background-color:#fff; color:#111; border-color:rgba(0,0,0,.12); }
}
</style>
<style>
/* tidy utils */
.container{width:min(1100px,92vw);margin:0 auto;padding:20px 0}
.card{margin:18px 0;padding:20px;border-radius:16px;border:1px solid rgba(255,255,255,.10);background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));box-shadow:0 8px 30px rgba(0,0,0,.25)}
.grid{display:grid;gap:14px}
.grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
.grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}
@media (max-width:900px){.grid-2,.grid-3{grid-template-columns:1fr}}
.input{width:100%;height:44px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.03);color:var(--text);padding:0 12px}
.btn{display:inline-flex;align-items:center;justify-content:center;height:44px;padding:0 16px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:linear-gradient(90deg, rgba(30,136,229,.25), rgba(0,234,255,.18));color:#fff;font-weight:700;cursor:pointer}
.muted{color:var(--muted)}
.video{width:100%;border-radius:16px;border:1px solid rgba(255,255,255,.08);overflow:hidden;aspect-ratio:16/9;background:#0b0e13}
.section-title{margin:10px 0 12px;font-size:20px}
</style>

<style>
/* ideal-mobile */
html,body{overflow-x:hidden}
img,video{max-width:100%;height:auto}
/* tap comfort */
.btn{min-height:48px}
/* tables: wrap for narrow screens */
.table-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch}
.table{min-width:560px}
/* burger */
@media (max-width:900px){
  .nav-links{display:none}
  .nav .burger{display:inline-flex}
}
.burger{display:none;align-items:center;justify-content:center;width:42px;height:42px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);cursor:pointer}
.burger span{display:block;width:18px;height:2px;background:#cfe9ff;position:relative}
.burger span:before,.burger span:after{content:"";position:absolute;left:0;width:18px;height:2px;background:#cfe9ff}
.burger span:before{top:-6px}.burger span:after{top:6px}
/* drawer */
.lc-drawer{position:fixed;inset:0;z-index:100;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);display:none}
.lc-drawer.is-open{display:block}
.lc-drawer__panel{position:absolute;right:0;top:0;height:100%;width:min(86vw,320px);background:#0b0e13;border-left:1px solid rgba(255,255,255,.08);padding:16px;overflow:auto}
.lc-drawer__panel a{display:block;padding:12px;border-radius:10px;color:#cfe9ff;text-decoration:none;border:1px solid rgba(255,255,255,.08);margin:6px 0}
</style>
<style>/* toast */.lc-toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;z-index:9999;display:flex;flex-direction:column;gap:8px;align-items:center}.lc-toast__item{background:#0b0e13;border:1px solid rgba(255,255,255,.12);color:#cfe9ff;padding:10px 14px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.35)}/* skeleton */.skel{position:relative;overflow:hidden;background:rgba(255,255,255,.06);border-radius:10px}.skel:after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.08),transparent);animation:sh 1.2s infinite}@keyframes sh{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}</style>
</head>
<body><header class="header noscript-header">
<div class="container nav">
<a class="brand" href="index.html"><span class="logo"></span><span>Litcash</span></a>
<nav class="nav-links">
<a href="index.html" data-i18n="home_nav" data-i18n="nav_home">Главная</a>
<a href="dashboard_single.html" data-i18n="dashboard_nav" data-i18n="nav_dashboard">Личный кабинет</a>
<a href="deposit_single.html" data-i18n="deposit_nav" data-i18n="deposit_title">Пополнение</a>
<a href="withdraw_single.html" data-i18n="withdraw_nav" data-i18n="withdraw_title">Вывод</a>
<a href="faq_single.html" data-i18n="faq_nav" data-i18n="faq_title">FAQ</a>
<a href="settings_single.html" data-i18n="settings_nav" data-i18n="settings_title">Настройки</a>
</nav>
<div class="burger" id="lc-burger" aria-label="Menu"><span></span></div>
<div class="lang"><div class="lc-lang">
<button aria-expanded="false" aria-haspopup="listbox" class="lc-lang__btn">
<svg aria-hidden="true" class="lc-lang__icon" viewbox="0 0 24 24">
<path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm0 18a8 8 0 0 1 0-16v16zm1-16a8 8 0 0 1 0 16V4zM4.7 7h14.6M4.7 17h14.6M12 2a15 15 0 0 0 0 20M12 2a15 15 0 0 1 0 20" fill="none" stroke="currentColor" stroke-width="1.2"></path>
</svg>
<span class="lc-lang__label">EN</span>
</button>
<ul class="lc-lang__menu" role="listbox" tabindex="-1">
<li data-lang="ru" role="option">RU Русский</li>
<li data-lang="en" role="option">GB English</li>
</ul>
</div></div><div class="nav-cta">
        <!-- Login/Register buttons support i18n -->
        <a class="btn ghost" href="login_single.html" data-i18n="nav_login" data-i18n="login_title">Вход</a>
        <a class="btn primary" href="register_single.html" data-i18n="nav_register" data-i18n="register_title">Регистрация</a>
</div>
</div>
</header>
<main class="container">
<section class="grid grid-3">
<div class="card" id="notActiveWarn" style="display:none;background:rgba(255,0,0,.06);border:1px solid rgba(255,0,0,.25)"><strong data-i18n="not_active_warning">Аккаунт не активен...</strong></div>
<div class="card"><div class="muted" data-i18n="balance">Баланс</div><div class="n" data-balance="" style="font-size:28px;font-weight:800">0.00 USDT</div></div>
<div class="card"><div class="muted" data-i18n="views">Просмотры</div><div class="n" data-views="" style="font-size:28px;font-weight:800">0</div></div>
<div class="card"><div class="muted">Уровень</div><div class="n" style="font-size:20px;font-weight:700"><span data-level="">—</span> <span class="badge" id="perViewBadge">+0.00 USDT за просмотр</span></div></div>
</section>
<section class="grid grid-3">
<div class="card"><div class="muted">Ставка</div><div class="n" data-rate="" style="font-size:22px;font-weight:700">—</div></div>
<div class="card"><div class="muted">Капитал (расч.)</div><div class="n" data-cap="" style="font-size:22px;font-weight:700">—</div></div>
<div class="card"><div class="muted">Рефералы</div><div class="n" data-refs="" style="font-size:22px;font-weight:700">0</div></div>
</section>
<section class="grid grid-2">
<div class="card">
<h2>Просмотр видео</h2>
<div class="video">
<video controls="" id="promoVid" class="video" preload="none" style="width:100%;height:100%">
<source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4"/>
        Ваш браузер не поддерживает видео тег.
      </video>
</div>
<div class="progress" style="margin:14px 0 8px"><div id="progressFill" style="width:0%"></div></div>
<div class="muted" id="progressText">Прогресс…</div>
<div class="flex" style="margin-top:14px">
<button class="btn start" id="startBtn">Заработать за просмотр</button>
<a class="btn" href="deposit_single.html">Пополнить</a>
</div>
</div>
<div class="card">
<h2>Реферальная панель</h2>
<div class="flex" style="gap:10px;flex-wrap:wrap">
<input class="input" id="refLink" readonly="" style="flex:1;min-width:240px;height:44px;padding:0 12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.03);color:var(--text)" value=""/>
<button class="btn" id="copyRef">Скопировать</button>
<div class="muted" style="margin-top:8px"><span data-i18n="views_left_today" data-i18n="views_left_today">Просмотров осталось сегодня</span>: <b id="viewsLeftToday" data-views-left>5</b></div>
</div>
<div class="grid grid-3" style="margin-top:12px">
<div class="card"><div class="muted" data-i18n="gen1"> 1 поколение</div><div id="gen1Count" style="font-size:22px;font-weight:700">0</div></div>
<div class="card"><div class="muted" data-i18n="gen2"> 2 поколение</div><div id="gen2Count" style="font-size:22px;font-weight:700">0</div></div>
<div class="card"><div class="muted" data-i18n="gen3"> 3 поколение</div><div id="gen3Count" style="font-size:22px;font-weight:700">0</div></div>
</div>
<div style="margin-top:12px">
<table class="table">
<thead><tr><th>Поколение</th><th>Email</th><th>Капитал</th><th>Уровень</th><th>Дата</th></tr></thead>
<tbody id="refTree"><tr><td class="muted" colspan="5">Нет данных</td></tr></tbody>
</table>
</div>
</div>
</section>
<section class="card">
<h2>Информационная таблица</h2>
<table class="table">
<thead><tr><th data-i18n="indicator">Показатель</th><th data-i18n="value">Значение</th><th data-i18n="comment">Комментарий</th></tr></thead>
<tbody id="infoRows">
  <tr>
    <td>Уровень</td>
    <td><span data-level-name>—</span></td>
    <td>Starter / Advanced / Pro Elite / Titanium</td>
  </tr>

  <tr>
    <td>Процент</td>
    <td><span data-rate="">—</span></td>
    <td>Начисляется от базового капитала уровня</td>
  </tr>

  <tr>
    <td>База уровня</td>
    <td><span id="baseCapCell">—</span></td>
    <td>min(капитал, потолок уровня)</td>
  </tr>

  <tr>
    <td>За 1 просмотр</td>
    <td>
      <span id="perViewCell">
        <span data-reward-per-view>0.00 USDT</span>
      </span>
    </td>
    <td>5 просмотров = полный дневной %</td>
  </tr>

  <tr>
    <td>За 5 просмотров (сегодня)</td>
    <td><span data-daily-reward>0.00 USDT</span></td>
    <td>Сумма за сутки по уровню</td>
  </tr>

  <tr>
    <td>Просмотров осталось сегодня</td>
    <td><span data-views-left>0</span></td>
    <td>Макс. 5 в день</td>
  </tr>

  <tr>
    <td>Цель следующего уровня</td>
    <td colspan="2"><span id="nextTargetCell">—</span></td>
  </tr>
</tbody>
</table>
</section>
<section class="grid grid-2">
<div class="card">
<h2 data-i18n="ref_income_title">Реферальный доход</h2>
<table class="table">
<thead><tr><th>Поколение</th><th>Сумма</th></tr></thead>
<tbody id="refRows">
<tr><td>1-е поколение (13%)</td><td id="gen1Cell">0.00 USDT</td></tr>
<tr><td>2-е поколение (5%)</td><td id="gen2Cell">0.00 USDT</td></tr>
<tr><td>3-е поколение (1%)</td><td id="gen3Cell">0.00 USDT</td></tr>
<tr><td><b>Итого</b></td><td id="refTotalCell"><b>0.00 USDT</b></td></tr>
</tbody>
</table>
</div>
<div class="card">
<h2 data-i18n="ref_recent_title">Последние реферальные начисления</h2>
<table class="table">
<thead><tr><th>Дата</th><th>Поколение</th><th>Сумма</th><th>Источник</th></tr></thead>
<tbody id="refList"><tr><td class="muted" colspan="4">Нет данных</td></tr></tbody>
</table>
</div>
</section>
</main>
<footer class="footer">
<div class="container">© 2025 Litcash. Все права защищены.</div>
</footer>
<script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script defer src="supabaseConfig.js"></script>
<script defer src="assets/js/i18n.js"></script>
<script defer src="app_supabase.js"></script>
<script defer src="assets/js/lang-switcher.js"></script>
<script id="lc-lang-script-inline" type="text/plain">
(function(){
  if (!window.LC_I18N) {
    const DEFAULT_LANG='ru', KEY='litcash_lang';
    const dict={ru:{}, en:{}}; // fill later as needed
    function getLang(){ try{ return localStorage.getItem(KEY)||DEFAULT_LANG }catch(e){ return DEFAULT_LANG } }
    function setLang(l){ try{ localStorage.setItem(KEY,l) }catch(e){} }
    function t(key,lang){ lang=lang||getLang(); if(dict[lang]&&key in dict[lang]) return dict[lang][key]; if(dict[DEFAULT_LANG]&&key in dict[DEFAULT_LANG]) return dict[DEFAULT_LANG][key]; return null }
    function apply(root=document){
      const lang=getLang();
      document.documentElement&&document.documentElement.setAttribute('lang',lang);
      const nodes=root.querySelectorAll('[data-i18n]');
      nodes.forEach(n=>{
        const key=n.getAttribute('data-i18n'); const val=t(key,lang);
        if(val!==null){ if(!n.firstElementChild) n.textContent=val; else n.innerHTML=val; }
        const attrs=(n.getAttribute('data-i18n-attr')||'').split(',').map(s=>s.trim()).filter(Boolean);
        attrs.forEach(a=>{ const v=t(key+':'+a,lang); if(v!==null) n.setAttribute(a,v); });
      });
    }
    window.LC_I18N={getLang,setLang,apply,t,dict};
    document.addEventListener('DOMContentLoaded',()=>apply());
  }
  // Bind globe
  function ready(fn){ if(document.readyState!=='loading') fn(); else document.addEventListener('DOMContentLoaded',fn); }
  ready(function(){
    var root = document.querySelector('#lc-inline-lang') || document.querySelector('.lc-lang');
    if (!root) return;
    var btn = root.querySelector('.lc-lang__btn');
    var menu = root.querySelector('.lc-lang__menu');
    if(!btn||!menu) return;
    function open(){ btn.setAttribute('aria-expanded','true'); root.classList.add('is-open'); menu.focus(); }
    function close(){ btn.setAttribute('aria-expanded','false'); root.classList.remove('is-open'); }
    btn.addEventListener('click', function(e){ e.preventDefault(); root.classList.contains('is-open')?close():open(); });
    document.addEventListener('click', function(e){ if(!root.contains(e.target)) close(); });
    menu.addEventListener('click', function(e){ var li=e.target.closest('[data-lang]'); if(!li) return; var lang=li.getAttribute('data-lang'); if(!lang) return; if(window.LC_I18N){ LC_I18N.setLang(lang); LC_I18N.apply(); } try{ localStorage.setItem('litcash_lang',lang) }catch(_){ } close(); });
    menu.addEventListener('keydown', function(e){ if(e.key==='Escape') close(); });
  });
})();
</script><script id="lc-lang-inline" type="text/plain">(function(){
  function ready(fn){ if(document.readyState!=='loading') fn(); else document.addEventListener('DOMContentLoaded',fn); }
  function getLang(){ try{return localStorage.getItem('litcash_lang')||'en'}catch(e){return 'en'} }
  function setLang(l){ try{localStorage.setItem('litcash_lang',l)}catch(e){} }
  ready(function(){
    var c=document.querySelector('.lc-lang'); if(!c) return;
    var btn=c.querySelector('.lc-lang__btn'), menu=c.querySelector('.lc-lang__menu'), label=c.querySelector('.lc-lang__label');
    if(!btn||!menu) return;
    function apply(){
      var lang=getLang();
      if(window.LC_I18N){ try{ LC_I18N.setLang(lang); LC_I18N.apply(); }catch(_){ } }
      if(label){ label.textContent = (lang==='ru'?'RU':'EN'); }
      try{ document.documentElement.setAttribute('lang', lang); }catch(_){}
    }
    function open(){ btn.setAttribute('aria-expanded','true'); c.classList.add('is-open'); menu.focus(); }
    function close(){ btn.setAttribute('aria-expanded','false'); c.classList.remove('is-open'); }
    btn.addEventListener('click', function(e){ e.preventDefault(); c.classList.contains('is-open')?close():open(); });
    document.addEventListener('click', function(e){ if(!c.contains(e.target)) close(); });
    menu.addEventListener('click', function(e){ var li=e.target.closest('[data-lang]'); if(!li) return; var lang=li.getAttribute('data-lang'); if(!lang) return; setLang(lang); apply(); close(); });
    menu.addEventListener('keydown', function(e){ if(e.key==='Escape') close(); });
    apply();
  });
})();</script><script id="lang-select-inline" type="text/plain">
(function(){
  function ready(fn){ if(document.readyState!=='loading') fn(); else document.addEventListener('DOMContentLoaded',fn); }
  ready(function(){
    var sel = document.querySelector('.lang-select') || document.getElementById('langSelect');
    if(!sel) return;
    // init value from storage
    try{
      var cur = localStorage.getItem('litcash_lang') || 'ru';
      if ([].some.call(sel.options, o => o.value === cur)) sel.value = cur;
    }catch(_){}
    function apply(l){
      try{ localStorage.setItem('litcash_lang', l); }catch(_){}
      if (window.LC_I18N) { try{ LC_I18N.setLang(l); LC_I18N.apply(); }catch(_){ } }
      try{ document.documentElement.setAttribute('lang', l); }catch(_){}
    }
    sel.addEventListener('change', function(){ apply(this.value); });
    // Also apply on load
    apply(sel.value);
  });
})();
</script>
<script>
document.addEventListener('DOMContentLoaded', async function(){
  try{
    const sb = window._supabase;
    if(!sb) return;
    const cta = document.querySelector('.nav-cta');
    const { data } = await sb.auth.getUser();
    const isAuth = !!(data && data.user);
    if(isAuth && cta){
      cta.innerHTML = '<button id="nav-logout" class="btn danger" data-i18n="nav_logout">Выйти</button>';
      const btn = document.getElementById('nav-logout');
      if(btn){ btn.addEventListener('click', function(e){ e.preventDefault(); if(window.logout){ logout(); } }); }
      // Apply i18n if available
      if(window.LC_I18N){ try{ LC_I18N.apply(); }catch(_){} }
    }
  }catch(_){}
});
</script>


<div class="lc-drawer" id="lc-drawer" aria-hidden="true">
  <div class="lc-drawer__panel">
    <nav id="lc-drawer-links"></nav>
    <div style="margin-top:12px" id="lc-drawer-cta"></div>
  </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function(){
  var burger=document.getElementById('lc-burger');
  var drawer=document.getElementById('lc-drawer');
  if(!burger||!drawer) return;
  var links=document.querySelector('.nav-links');
  var cta=document.querySelector('.nav-cta');
  var dl=document.getElementById('lc-drawer-links');
  var dc=document.getElementById('lc-drawer-cta');
  function open(){ drawer.classList.add('is-open'); drawer.setAttribute('aria-hidden','false'); }
  function close(){ drawer.classList.remove('is-open'); drawer.setAttribute('aria-hidden','true'); }
  burger.addEventListener('click', function(e){ e.preventDefault(); open(); });
  drawer.addEventListener('click', function(e){ if(e.target===drawer) close(); });
  // Clone links/cta
  if(links && dl){ dl.innerHTML = links.outerHTML; }
  if(cta && dc){ dc.innerHTML = cta.outerHTML; }
});
</script>

<script>window.LC_TOAST=(function(){let box;function ensure(){if(!box){box=document.createElement('div');box.className='lc-toast';document.body.appendChild(box);}}function show(msg){ensure();const item=document.createElement('div');item.className='lc-toast__item';item.textContent=msg;box.appendChild(item);setTimeout(()=>{item.remove();},1700);}return{ok:show,err:show};})();</script>
<div id="refLinkWrap" style="display:none;margin:1rem 0;">
</div>
<script>
document.addEventListener('DOMContentLoaded', () => {
  if (!window.LC || !window.sb) return;

  // маленький хелпер чтобы ставить текст сразу во все совпадения
  function setTextAll(selector, text) {
    document.querySelectorAll(selector).forEach(el => { el.textContent = text; });
  }

  window.LC.loadLevelInfo = async function () {
    try {
      const { data: { session } } = await window.sb.auth.getSession();
      if (!session) return;

      const { data, error } = await window.sb.rpc('get_level_info');
      if (error) { console.error(error); return; }
      const info = Array.isArray(data) ? data[0] : data;
      if (!info) return;

      const usd = (c) => (Number(c || 0) / 100).toFixed(2) + ' USDT';

      // 1) Уровень (обновляем все места)
      const lvlName = info.level_name || info.lvl_name || info.level_key || '—';
      setTextAll('[data-level],[data-level-name]', lvlName);

      // 2) Процент (bps -> %) — обновляем все [data-rate]
      const bp = Number(
        info.reward_percent_bp ?? info.pct_bp ?? info.percent_bp ?? 0
      );
      const percent = (bp / 100).toFixed(2) + ' %';
      setTextAll('[data-rate]', percent);

      // 3) За 1 просмотр
      const perViewCents = Number(info.reward_per_view_cents ?? info.per_view_cents ?? 0);
      const pvText = usd(perViewCents);
      const pvSpan = document.querySelector('[data-reward-per-view]');
      if (pvSpan) pvSpan.textContent = pvText;
      const pvBadge = document.getElementById('perViewBadge');
      if (pvBadge) pvBadge.textContent = `+${pvText} за просмотр`;

      // 4) За 5 просмотров (в день)
      setTextAll('[data-daily-reward]', usd(info.daily_reward_cents ?? info.daily_reward ?? 0));

      // 5) Осталось просмотров сегодня — обновляем все места
      const left = Number(
        info.views_left_today ?? ((info.daily_limit ?? 5) - (info.views_used_today ?? 0)) ?? 0
      );
      setTextAll('[data-views-left]', Math.max(left, 0));

      // 6) База уровня
      const baseCents = Number(info.base_amount_cents ?? info.base_cap_cents ?? 0);
      const bcEl = document.getElementById('baseCapCell');
      if (bcEl) bcEl.textContent = usd(baseCents);

      // 7) Капитал (расч.) карточка
      const capEl = document.querySelector('[data-cap]');
      if (capEl) capEl.textContent = usd(baseCents);

      // 8) Рефералы
      const refsEl = document.querySelector('[data-refs]');
      if (refsEl) refsEl.textContent = Number(info.refs_total ?? info.active_refs ?? 0);

      // 9) Индикация активности
      const warn = document.getElementById('notActiveWarn');
      if (warn) warn.style.display = (info.is_active === false) ? '' : 'none';

      // 10) Цель следующего уровня (если есть)
      const ntEl = document.getElementById('nextTargetCell');
      if (ntEl && info.next_target) ntEl.textContent = String(info.next_target);
    } catch (e) { console.error(e); }
  };

  window.LC.loadLevelInfo();
});
</script>

<script defer src="assets/js/guard.js"></script>

<script defer>
document.addEventListener('DOMContentLoaded', () => {
  try{
    const sb = window.sb;
    const reload = window.LC && window.LC.loadLevelInfo ? window.LC.loadLevelInfo : null;
    const btn = document.getElementById('startBtn');
    if (!sb || !btn) return;

    async function award(){
      const video = document.querySelector('video');
      const videoId = (video && (video.currentSrc || video.dataset.id)) || 'video-1';
      const { data, error } = await sb.rpc('award_view', { p_video_id: videoId });
      if (error){ alert(error.message || 'Ошибка начисления'); return; }
      if (!data || !data.ok){
        alert(data && data.reason === 'limit' ? 'Лимит 5 просмотров на сегодня' : 'Не удалось зачесть просмотр');
        return;
      }
      if (reload) await reload();
      // Обновим прогресс-бар, если он есть
      const leftEl = document.querySelector('[data-views-left]');
      const progressText = document.getElementById('progressText');
      const fill = document.getElementById('progressFill');
      if (leftEl && progressText){
        const left = parseInt(leftEl.textContent || '0', 10);
        progressText.textContent = `Просмотров осталось сегодня: ${left}`;
      }
      if (fill && reload){
        // reload уже обновит цифры; здесь можно плавно подсветить
        fill.style.transition = 'width .4s ease';
      }
    }

    btn.addEventListener('click', award);
    const video = document.querySelector('video');
    if (video) video.addEventListener('ended', award);
  }catch(e){ console.error(e); }
});
</script>

</body></html>
